import pandas as pd


datasets = {
    "Benin": pd.read_csv("../data/benin-malanville.csv"),
    "Sierra Leone": pd.read_csv("../data/sierraleone-bumbuna.csv"),
    "Togo": pd.read_csv("../data/togo-dapaong_qc.csv"),
}

for name, df in datasets.items():
    print(f"Dataset: {name}")
    print(df.info())
    print(df.describe())





# out put
Dataset: Benin
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 525600 entries, 0 to 525599
Data columns (total 19 columns):
 #   Column         Non-Null Count   Dtype  
---  ------         --------------   -----  
 0   Timestamp      525600 non-null  object 
 1   GHI            525600 non-null  float64
 2   DNI            525600 non-null  float64
 3   DHI            525600 non-null  float64
 4   ModA           525600 non-null  float64
 5   ModB           525600 non-null  float64
 6   Tamb           525600 non-null  float64
 7   RH             525600 non-null  float64
 8   WS             525600 non-null  float64
 9   WSgust         525600 non-null  float64
 10  WSstdev        525600 non-null  float64
 11  WD             525600 non-null  float64
 12  WDstdev        525600 non-null  float64
 13  BP             525600 non-null  int64  
 14  Cleaning       525600 non-null  int64  
 15  Precipitation  525600 non-null  float64
 16  TModA          525600 non-null  float64
 17  TModB          525600 non-null  float64
 18  Comments       0 non-null       float64
dtypes: float64(16), int64(2), object(1)
memory usage: 76.2+ MB
None
                 GHI            DNI            DHI           ModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      240.559452     167.187516     115.358961     236.589496   
std       331.131327     261.710501     158.691074     326.894859   
min       -12.900000      -7.800000     -12.600000       0.000000   
25%        -2.000000      -0.500000      -2.100000       0.000000   
50%         1.800000      -0.100000       1.600000       4.500000   
75%       483.400000     314.200000     216.300000     463.700000   
max      1413.000000     952.300000     759.200000    1342.300000   

                ModB           Tamb             RH             WS  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      228.883576      28.179683      54.487969       2.121113   
std       316.536515       5.924297      28.073069       1.603466   
min         0.000000      11.000000       2.100000       0.000000   
25%         0.000000      24.200000      28.800000       1.000000   
50%         4.300000      28.000000      55.100000       1.900000   
75%       447.900000      32.300000      80.100000       3.100000   
max      1342.300000      43.800000     100.000000      19.500000   

              WSgust        WSstdev             WD        WDstdev  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean        2.809195       0.473390     153.435172       8.582407   
std         2.029120       0.273395     102.332842       6.385864   
min         0.000000       0.000000       0.000000       0.000000   
25%         1.300000       0.400000      59.000000       3.700000   
50%         2.600000       0.500000     181.000000       8.600000   
75%         4.100000       0.600000     235.100000      12.300000   
max        26.600000       4.200000     360.000000      99.400000   

                  BP       Cleaning  Precipitation          TModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      994.197199       0.000923       0.001905      35.246026   
std         2.474993       0.030363       0.037115      14.807258   
min       985.000000       0.000000       0.000000       9.000000   
25%       993.000000       0.000000       0.000000      24.200000   
50%       994.000000       0.000000       0.000000      30.000000   
75%       996.000000       0.000000       0.000000      46.900000   
max      1003.000000       1.000000       2.500000      81.000000   

               TModB  Comments  
count  525600.000000       0.0  
mean       32.471736       NaN  
std        12.348743       NaN  
min         8.100000       NaN  
25%        23.600000       NaN  
50%        28.900000       NaN  
75%        41.500000       NaN  
max        72.500000       NaN  
Dataset: Sierra Leone
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 525600 entries, 0 to 525599
Data columns (total 19 columns):
 #   Column         Non-Null Count   Dtype  
---  ------         --------------   -----  
 0   Timestamp      525600 non-null  object 
 1   GHI            525600 non-null  float64
 2   DNI            525600 non-null  float64
 3   DHI            525600 non-null  float64
 4   ModA           525600 non-null  float64
 5   ModB           525600 non-null  float64
 6   Tamb           525600 non-null  float64
 7   RH             525600 non-null  float64
 8   WS             525600 non-null  float64
 9   WSgust         525600 non-null  float64
 10  WSstdev        525600 non-null  float64
 11  WD             525600 non-null  float64
 12  WDstdev        525600 non-null  float64
 13  BP             525600 non-null  int64  
 14  Cleaning       525600 non-null  int64  
 15  Precipitation  525600 non-null  float64
 16  TModA          525600 non-null  float64
 17  TModB          525600 non-null  float64
 18  Comments       0 non-null       float64
dtypes: float64(16), int64(2), object(1)
memory usage: 76.2+ MB
None
                 GHI            DNI            DHI           ModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      201.957515     116.376337     113.720571     206.643095   
std       298.495150     218.652659     158.946032     300.896893   
min       -19.500000      -7.800000     -17.900000       0.000000   
25%        -2.800000      -0.300000      -3.800000       0.000000   
50%         0.300000      -0.100000      -0.100000       3.600000   
75%       362.400000     107.000000     224.700000     359.500000   
max      1499.000000     946.000000     892.000000    1507.000000   

                ModB           Tamb             RH             WS  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      198.114691      26.319394      79.448857       1.146113   
std       288.889073       4.398605      20.520775       1.239248   
min         0.000000      12.300000       9.900000       0.000000   
25%         0.000000      23.100000      68.700000       0.000000   
50%         3.400000      25.300000      85.400000       0.800000   
75%       345.400000      29.400000      96.700000       2.000000   
max      1473.000000      39.900000     100.000000      19.200000   

              WSgust        WSstdev             WD        WDstdev  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean        1.691606       0.363823     133.044668       7.172220   
std         1.617053       0.295000     114.284792       7.535093   
min         0.000000       0.000000       0.000000       0.000000   
25%         0.000000       0.000000       0.000000       0.000000   
50%         1.600000       0.400000     161.500000       6.200000   
75%         2.600000       0.600000     234.100000      12.000000   
max        23.900000       4.100000     360.000000      98.400000   

                  BP       Cleaning  Precipitation          TModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      999.876469       0.000967       0.004806      32.504263   
std         2.104419       0.031074       0.047556      12.434899   
min       993.000000       0.000000       0.000000      10.700000   
25%       999.000000       0.000000       0.000000      23.500000   
50%      1000.000000       0.000000       0.000000      26.600000   
75%      1001.000000       0.000000       0.000000      40.900000   
max      1006.000000       1.000000       2.400000      72.800000   

               TModB  Comments  
count  525600.000000       0.0  
mean       32.593091       NaN  
std        12.009161       NaN  
min        11.100000       NaN  
25%        23.800000       NaN  
50%        26.900000       NaN  
75%        41.300000       NaN  
max        70.400000       NaN  
Dataset: Togo
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 525600 entries, 0 to 525599
Data columns (total 19 columns):
 #   Column         Non-Null Count   Dtype  
---  ------         --------------   -----  
 0   Timestamp      525600 non-null  object 
 1   GHI            525600 non-null  float64
 2   DNI            525600 non-null  float64
 3   DHI            525600 non-null  float64
 4   ModA           525600 non-null  float64
 5   ModB           525600 non-null  float64
 6   Tamb           525600 non-null  float64
 7   RH             525600 non-null  float64
 8   WS             525600 non-null  float64
 9   WSgust         525600 non-null  float64
 10  WSstdev        525600 non-null  float64
 11  WD             525600 non-null  float64
 12  WDstdev        525600 non-null  float64
 13  BP             525600 non-null  int64  
 14  Cleaning       525600 non-null  int64  
 15  Precipitation  525600 non-null  float64
 16  TModA          525600 non-null  float64
 17  TModB          525600 non-null  float64
 18  Comments       0 non-null       float64
dtypes: float64(16), int64(2), object(1)
memory usage: 76.2+ MB
None
                 GHI            DNI            DHI           ModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      230.555040     151.258469     116.444352     226.144375   
std       322.532347     250.956962     156.520714     317.346938   
min       -12.700000       0.000000       0.000000       0.000000   
25%        -2.200000       0.000000       0.000000       0.000000   
50%         2.100000       0.000000       2.500000       4.400000   
75%       442.400000     246.400000     215.700000     422.525000   
max      1424.000000    1004.500000     805.700000    1380.000000   

                ModB           Tamb             RH             WS  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      219.568588      27.751788      55.013160       2.368093   
std       307.932510       4.758023      28.778732       1.462668   
min         0.000000      14.900000       3.300000       0.000000   
25%         0.000000      24.200000      26.500000       1.400000   
50%         4.300000      27.200000      59.300000       2.200000   
75%       411.000000      31.100000      80.800000       3.200000   
max      1367.000000      41.400000      99.800000      16.100000   

              WSgust        WSstdev             WD        WDstdev  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean        3.229490       0.557740     161.741845      10.559568   
std         1.882565       0.268923      91.877217       5.915490   
min         0.000000       0.000000       0.000000       0.000000   
25%         1.900000       0.400000      74.800000       6.900000   
50%         2.900000       0.500000     199.100000      10.800000   
75%         4.400000       0.700000     233.500000      14.100000   
max        23.100000       4.700000     360.000000      86.900000   

                  BP       Cleaning  Precipitation          TModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      975.915242       0.000535       0.001382      32.444403   
std         2.153977       0.023116       0.026350      10.998334   
min       968.000000       0.000000       0.000000      13.100000   
25%       975.000000       0.000000       0.000000      23.900000   
50%       976.000000       0.000000       0.000000      28.400000   
75%       977.000000       0.000000       0.000000      40.600000   
max       983.000000       1.000000       2.300000      70.400000   

               TModB  Comments  
count  525600.000000       0.0  
mean       33.543330       NaN  
std        12.769277       NaN  
min        13.100000       NaN  
25%        23.600000       NaN  
50%        28.400000       NaN  
75%        43.000000       NaN  
max        94.600000       NaN  





for name, df in datasets.items():
    print(f"Summary for {name}:")
    print(df.describe())

#out put 

Summary for Benin:
                 GHI            DNI            DHI           ModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      240.559452     167.187516     115.358961     236.589496   
std       331.131327     261.710501     158.691074     326.894859   
min       -12.900000      -7.800000     -12.600000       0.000000   
25%        -2.000000      -0.500000      -2.100000       0.000000   
50%         1.800000      -0.100000       1.600000       4.500000   
75%       483.400000     314.200000     216.300000     463.700000   
max      1413.000000     952.300000     759.200000    1342.300000   

                ModB           Tamb             RH             WS  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      228.883576      28.179683      54.487969       2.121113   
std       316.536515       5.924297      28.073069       1.603466   
min         0.000000      11.000000       2.100000       0.000000   
25%         0.000000      24.200000      28.800000       1.000000   
50%         4.300000      28.000000      55.100000       1.900000   
75%       447.900000      32.300000      80.100000       3.100000   
max      1342.300000      43.800000     100.000000      19.500000   

              WSgust        WSstdev             WD        WDstdev  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean        2.809195       0.473390     153.435172       8.582407   
std         2.029120       0.273395     102.332842       6.385864   
min         0.000000       0.000000       0.000000       0.000000   
25%         1.300000       0.400000      59.000000       3.700000   
50%         2.600000       0.500000     181.000000       8.600000   
75%         4.100000       0.600000     235.100000      12.300000   
max        26.600000       4.200000     360.000000      99.400000   

                  BP       Cleaning  Precipitation          TModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      994.197199       0.000923       0.001905      35.246026   
std         2.474993       0.030363       0.037115      14.807258   
min       985.000000       0.000000       0.000000       9.000000   
25%       993.000000       0.000000       0.000000      24.200000   
50%       994.000000       0.000000       0.000000      30.000000   
75%       996.000000       0.000000       0.000000      46.900000   
max      1003.000000       1.000000       2.500000      81.000000   

               TModB  Comments  
count  525600.000000       0.0  
mean       32.471736       NaN  
std        12.348743       NaN  
min         8.100000       NaN  
25%        23.600000       NaN  
50%        28.900000       NaN  
75%        41.500000       NaN  
max        72.500000       NaN  
Summary for Sierra Leone:
                 GHI            DNI            DHI           ModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      201.957515     116.376337     113.720571     206.643095   
std       298.495150     218.652659     158.946032     300.896893   
min       -19.500000      -7.800000     -17.900000       0.000000   
25%        -2.800000      -0.300000      -3.800000       0.000000   
50%         0.300000      -0.100000      -0.100000       3.600000   
75%       362.400000     107.000000     224.700000     359.500000   
max      1499.000000     946.000000     892.000000    1507.000000   

                ModB           Tamb             RH             WS  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      198.114691      26.319394      79.448857       1.146113   
std       288.889073       4.398605      20.520775       1.239248   
min         0.000000      12.300000       9.900000       0.000000   
25%         0.000000      23.100000      68.700000       0.000000   
50%         3.400000      25.300000      85.400000       0.800000   
75%       345.400000      29.400000      96.700000       2.000000   
max      1473.000000      39.900000     100.000000      19.200000   

              WSgust        WSstdev             WD        WDstdev  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean        1.691606       0.363823     133.044668       7.172220   
std         1.617053       0.295000     114.284792       7.535093   
min         0.000000       0.000000       0.000000       0.000000   
25%         0.000000       0.000000       0.000000       0.000000   
50%         1.600000       0.400000     161.500000       6.200000   
75%         2.600000       0.600000     234.100000      12.000000   
max        23.900000       4.100000     360.000000      98.400000   

                  BP       Cleaning  Precipitation          TModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      999.876469       0.000967       0.004806      32.504263   
std         2.104419       0.031074       0.047556      12.434899   
min       993.000000       0.000000       0.000000      10.700000   
25%       999.000000       0.000000       0.000000      23.500000   
50%      1000.000000       0.000000       0.000000      26.600000   
75%      1001.000000       0.000000       0.000000      40.900000   
max      1006.000000       1.000000       2.400000      72.800000   

               TModB  Comments  
count  525600.000000       0.0  
mean       32.593091       NaN  
std        12.009161       NaN  
min        11.100000       NaN  
25%        23.800000       NaN  
50%        26.900000       NaN  
75%        41.300000       NaN  
max        70.400000       NaN  
Summary for Togo:
                 GHI            DNI            DHI           ModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      230.555040     151.258469     116.444352     226.144375   
std       322.532347     250.956962     156.520714     317.346938   
min       -12.700000       0.000000       0.000000       0.000000   
25%        -2.200000       0.000000       0.000000       0.000000   
50%         2.100000       0.000000       2.500000       4.400000   
75%       442.400000     246.400000     215.700000     422.525000   
max      1424.000000    1004.500000     805.700000    1380.000000   

                ModB           Tamb             RH             WS  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      219.568588      27.751788      55.013160       2.368093   
std       307.932510       4.758023      28.778732       1.462668   
min         0.000000      14.900000       3.300000       0.000000   
25%         0.000000      24.200000      26.500000       1.400000   
50%         4.300000      27.200000      59.300000       2.200000   
75%       411.000000      31.100000      80.800000       3.200000   
max      1367.000000      41.400000      99.800000      16.100000   

              WSgust        WSstdev             WD        WDstdev  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean        3.229490       0.557740     161.741845      10.559568   
std         1.882565       0.268923      91.877217       5.915490   
min         0.000000       0.000000       0.000000       0.000000   
25%         1.900000       0.400000      74.800000       6.900000   
50%         2.900000       0.500000     199.100000      10.800000   
75%         4.400000       0.700000     233.500000      14.100000   
max        23.100000       4.700000     360.000000      86.900000   

                  BP       Cleaning  Precipitation          TModA  \
count  525600.000000  525600.000000  525600.000000  525600.000000   
mean      975.915242       0.000535       0.001382      32.444403   
std         2.153977       0.023116       0.026350      10.998334   
min       968.000000       0.000000       0.000000      13.100000   
25%       975.000000       0.000000       0.000000      23.900000   
50%       976.000000       0.000000       0.000000      28.400000   
75%       977.000000       0.000000       0.000000      40.600000   
max       983.000000       1.000000       2.300000      70.400000   

               TModB  Comments  
count  525600.000000       0.0  
mean       33.543330       NaN  
std        12.769277       NaN  
min        13.100000       NaN  
25%        23.600000       NaN  
50%        28.400000       NaN  
75%        43.000000       NaN  
max        94.600000       NaN  






for name, df in datasets.items():
    print(f"Missing Values in {name}:")
    print(df.isnull().sum())


# out put


Missing Values in Benin:
Timestamp             0
GHI                   0
DNI                   0
DHI                   0
ModA                  0
ModB                  0
Tamb                  0
RH                    0
WS                    0
WSgust                0
WSstdev               0
WD                    0
WDstdev               0
BP                    0
Cleaning              0
Precipitation         0
TModA                 0
TModB                 0
Comments         525600
dtype: int64
Missing Values in Sierra Leone:
Timestamp             0
GHI                   0
DNI                   0
DHI                   0
ModA                  0
ModB                  0
Tamb                  0
RH                    0
WS                    0
WSgust                0
WSstdev               0
WD                    0
WDstdev               0
BP                    0
Cleaning              0
Precipitation         0
TModA                 0
TModB                 0
Comments         525600
dtype: int64
Missing Values in Togo:
Timestamp             0
GHI                   0
DNI                   0
DHI                   0
ModA                  0
ModB                  0
Tamb                  0
RH                    0
WS                    0
WSgust                0
WSstdev               0
WD                    0
WDstdev               0
BP                    0
Cleaning              0
Precipitation         0
TModA                 0
TModB                 0
Comments         525600
dtype: int64






for name, df in datasets.items():
    invalid_ghi = df[df["GHI"] < 0]
    print(f"Invalid GHI values in {name}:\n", invalid_ghi)
# out put



Invalid GHI values in Benin:
                Timestamp  GHI  DNI  DHI  ModA  ModB  Tamb    RH   WS  WSgust  \
0       2021-08-09 00:01 -1.2 -0.2 -1.1   0.0   0.0  26.2  93.4  0.0     0.4   
1       2021-08-09 00:02 -1.1 -0.2 -1.1   0.0   0.0  26.2  93.6  0.0     0.0   
2       2021-08-09 00:03 -1.1 -0.2 -1.1   0.0   0.0  26.2  93.7  0.3     1.1   
3       2021-08-09 00:04 -1.1 -0.1 -1.0   0.0   0.0  26.2  93.3  0.2     0.7   
4       2021-08-09 00:05 -1.0 -0.1 -1.0   0.0   0.0  26.2  93.3  0.1     0.7   
...                  ...  ...  ...  ...   ...   ...   ...   ...  ...     ...   
525595  2022-08-08 23:56 -5.5 -0.1 -5.9   0.0   0.0  23.1  98.3  0.3     1.1   
525596  2022-08-08 23:57 -5.5 -0.1 -5.8   0.0   0.0  23.1  98.3  0.2     0.7   
525597  2022-08-08 23:58 -5.5 -0.1 -5.8   0.0   0.0  23.1  98.4  0.6     1.1   
525598  2022-08-08 23:59 -5.5 -0.1 -5.8   0.0   0.0  23.1  98.3  0.9     1.3   
525599  2022-08-09 00:00 -5.5 -0.1 -5.7   0.0   0.0  23.1  98.3  1.2     1.6   

        WSstdev     WD  WDstdev   BP  Cleaning  Precipitation  TModA  TModB  \
0           0.1  122.1      0.0  998         0            0.0   26.3   26.2   
1           0.0    0.0      0.0  998         0            0.0   26.3   26.2   
2           0.5  124.6      1.5  997         0            0.0   26.4   26.2   
3           0.4  120.3      1.3  997         0            0.0   26.4   26.3   
4           0.3  113.2      1.0  997         0            0.0   26.4   26.3   
...         ...    ...      ...  ...       ...            ...    ...    ...   
525595      0.5  119.3      4.1  996         0            0.0   23.5   22.9   
525596      0.4  115.2      2.3  996         0            0.0   23.5   22.9   
525597      0.5  129.8      3.4  996         0            0.0   23.5   22.9   
525598      0.5  124.4      4.3  996         0            0.0   23.5   22.9   
525599      0.3  124.1      5.9  996         0            0.0   23.5   22.9   

        Comments  
0            NaN  
1            NaN  
2            NaN  
3            NaN  
4            NaN  
...          ...  
525595       NaN  
525596       NaN  
525597       NaN  
525598       NaN  
525599       NaN  

[258847 rows x 19 columns]
Invalid GHI values in Sierra Leone:
                Timestamp  GHI  DNI  DHI  ModA  ModB  Tamb     RH   WS  WSgust  \
0       2021-10-30 00:01 -0.7 -0.1 -0.8   0.0   0.0  21.9   99.1  0.0     0.0   
1       2021-10-30 00:02 -0.7 -0.1 -0.8   0.0   0.0  21.9   99.2  0.0     0.0   
2       2021-10-30 00:03 -0.7 -0.1 -0.8   0.0   0.0  21.9   99.2  0.0     0.0   
3       2021-10-30 00:04 -0.7  0.0 -0.8   0.0   0.0  21.9   99.3  0.0     0.0   
4       2021-10-30 00:05 -0.7 -0.1 -0.8   0.0   0.0  21.9   99.3  0.0     0.0   
...                  ...  ...  ...  ...   ...   ...   ...    ...  ...     ...   
525595  2022-10-29 23:56 -1.6 -0.1 -2.9   0.0   0.0  24.0  100.0  0.0     0.0   
525596  2022-10-29 23:57 -1.7 -0.1 -3.0   0.0   0.0  24.0  100.0  0.0     0.0   
525597  2022-10-29 23:58 -1.7 -0.1 -3.1   0.0   0.0  24.0  100.0  0.0     0.0   
525598  2022-10-29 23:59 -1.7 -0.2 -3.3   0.0   0.0  23.9  100.0  0.0     0.0   
525599  2022-10-30 00:00 -1.7 -0.1 -3.4   0.0   0.0  23.9  100.0  0.0     0.0   

        WSstdev   WD  WDstdev    BP  Cleaning  Precipitation  TModA  TModB  \
0           0.0  0.0      0.0  1002         0            0.0   22.3   22.6   
1           0.0  0.0      0.0  1002         0            0.0   22.3   22.6   
2           0.0  0.0      0.0  1002         0            0.0   22.3   22.6   
3           0.0  0.0      0.0  1002         0            0.1   22.3   22.6   
4           0.0  0.0      0.0  1002         0            0.0   22.3   22.6   
...         ...  ...      ...   ...       ...            ...    ...    ...   
525595      0.0  0.0      0.0   999         0            0.0   24.2   24.5   
525596      0.0  0.0      0.0   999         0            0.0   24.2   24.5   
525597      0.0  0.0      0.0  1000         0            0.0   24.1   24.4   
525598      0.0  0.0      0.0  1000         0            0.0   24.1   24.4   
525599      0.0  0.0      0.0  1000         0            0.0   24.1   24.4   

        Comments  
0            NaN  
1            NaN  
2            NaN  
3            NaN  
4            NaN  
...          ...  
525595       NaN  
525596       NaN  
525597       NaN  
525598       NaN  
525599       NaN  

[261135 rows x 19 columns]
Invalid GHI values in Togo:
                Timestamp  GHI  DNI  DHI  ModA  ModB  Tamb    RH   WS  WSgust  \
0       2021-10-25 00:01 -1.3  0.0  0.0   0.0   0.0  24.8  94.5  0.9     1.1   
1       2021-10-25 00:02 -1.3  0.0  0.0   0.0   0.0  24.8  94.4  1.1     1.6   
2       2021-10-25 00:03 -1.3  0.0  0.0   0.0   0.0  24.8  94.4  1.2     1.4   
3       2021-10-25 00:04 -1.2  0.0  0.0   0.0   0.0  24.8  94.3  1.2     1.6   
4       2021-10-25 00:05 -1.2  0.0  0.0   0.0   0.0  24.8  94.0  1.3     1.6   
...                  ...  ...  ...  ...   ...   ...   ...   ...  ...     ...   
525595  2022-10-24 23:56 -0.8  0.0  0.0   0.0   0.0  25.2  53.8  0.0     0.0   
525596  2022-10-24 23:57 -0.9  0.0  0.0   0.0   0.0  25.3  53.5  0.0     0.0   
525597  2022-10-24 23:58 -1.0  0.0  0.0   0.0   0.0  25.3  53.4  0.0     0.0   
525598  2022-10-24 23:59 -1.1  0.0  0.0   0.0   0.0  25.4  53.5  0.0     0.0   
525599  2022-10-25 00:00 -1.2  0.0  0.0   0.0   0.0  25.4  52.3  0.0     0.0   

        WSstdev     WD  WDstdev   BP  Cleaning  Precipitation  TModA  TModB  \
0           0.4  227.6      1.1  977         0            0.0   24.7   24.4   
1           0.4  229.3      0.7  977         0            0.0   24.7   24.4   
2           0.3  228.5      2.9  977         0            0.0   24.7   24.4   
3           0.3  229.1      4.6  977         0            0.0   24.7   24.4   
4           0.4  227.5      1.6  977         0            0.0   24.7   24.4   
...         ...    ...      ...  ...       ...            ...    ...    ...   
525595      0.0    0.0      0.0  977         0            0.0   24.3   24.0   
525596      0.0    0.0      0.0  977         0            0.0   24.3   24.0   
525597      0.0    0.0      0.0  977         0            0.0   24.2   23.9   
525598      0.0    0.0      0.0  977         0            0.0   24.1   23.8   
525599      0.0    0.0      0.0  977         0            0.0   24.1   23.8   

        Comments  
0            NaN  
1            NaN  
2            NaN  
3            NaN  
4            NaN  
...          ...  
525595       NaN  
525596       NaN  
525597       NaN  
525598       NaN  
525599       NaN  

[257385 rows x 19 columns]






# DATA VISUALISATION
# For OutLiers

import seaborn as sns
import matplotlib.pyplot as plt

for name, df in datasets.items():
    sns.boxplot(data=df[["GHI", "DNI", "DHI"]])
    plt.title(f"Outliers in {name}")
    plt.show()


# visualisation for Timeseries

for name, df in datasets.items():
    df["Timestamp"] = pd.to_datetime(df["Timestamp"])
    df.set_index("Timestamp", inplace=True)
    df[["GHI", "DNI", "DHI"]].plot(title=f"Time Series for {name}")
    plt.show()



# visualisation for corelation heatpmap

import seaborn as sns
import matplotlib.pyplot as plt
import numpy as np

for name, df in datasets.items():
    correlation = df.corr()
    
    mask = np.triu(np.ones_like(correlation, dtype=bool))
    
    plt.figure(figsize=(10, 8))  
    sns.heatmap(correlation, 
                annot=True, 
                cmap="coolwarm", 
                fmt=".2f",  
                annot_kws={"size": 10},  
                mask=mask,  
                linewidths=0.5,  
                cbar_kws={"shrink": 0.8})  
    
    plt.title(f"Correlation Heatmap for {name}")
    plt.show()


# visualisation for wind speed and direction


for name, df in datasets.items():
    sns.scatterplot(x=df["WS"], y=df["WD"], hue=df["GHI"])
    plt.title(f"Wind Speed and Direction for {name}")
    plt.show()


# visualisation for relative humidity vs GHI


for name, df in datasets.items():
    sns.scatterplot(x=df["RH"], y=df["GHI"])
    plt.title(f"Relative Humidity vs. GHI for {name}")
    plt.show()



# visualisation for relative humidity vs GHI

#Investigate RH's impact:
for name, df in datasets.items():
    sns.scatterplot(x=df["RH"], y=df["GHI"])
    plt.title(f"Relative Humidity vs. GHI for {name}")
    plt.show()

# visualisation for historgram

# out put

import matplotlib.pyplot as plt

bins = 20  
for name, df in datasets.items():
    plt.figure(figsize=(8, 6))  
    df["GHI"].hist(bins=bins, color="skyblue", edgecolor="black", alpha=0.7)
    
    plt.title(f"Histogram of GHI for {name}", fontsize=14)
    plt.xlabel("GHI (Global Horizontal Irradiance)", fontsize=12)
    plt.ylabel("Frequency", fontsize=12)
    plt.grid(axis="y", linestyle="--", alpha=0.7)  
    
    plt.show()




#Z-Score Analysis
from scipy.stats import zscore

for name, df in datasets.items():
    df["z_ghi"] = zscore(df["GHI"].dropna())
    anomalies = df[df["z_ghi"] > 3]
    print(f"Anomalies in {name}:\n", anomalies)


Anomalies in Benin:
                         GHI    DNI    DHI    ModA    ModB  Tamb    RH   WS  \
Timestamp                                                                    
2021-08-09 11:12:00  1274.0  698.8  615.2  1210.3  1210.3  30.1  69.6  3.4   
2021-08-09 11:15:00  1349.0  771.8  618.0  1281.5  1281.5  30.9  67.1  4.0   
2021-08-09 11:17:00  1334.0  751.9  620.0  1267.3  1267.3  31.1  67.0  2.7   
2021-08-09 14:10:00  1253.0  714.8  552.5  1156.0  1155.0  31.0  64.2  3.3   
2021-08-09 14:11:00  1324.0  813.0  532.3  1218.0  1217.0  31.0  62.9  2.2   
...                     ...    ...    ...     ...     ...   ...   ...  ...   
2022-08-03 13:38:00  1268.0  652.5  612.1  1163.0  1150.0  30.1  70.7  2.7   
2022-08-05 13:40:00  1280.0  778.5  497.2  1168.0  1161.0  29.0  70.3  3.8   
2022-08-05 14:17:00  1244.0  745.2  530.4  1126.0  1118.0  30.8  64.3  3.0   
2022-08-06 13:15:00  1262.0  772.4  475.8  1166.0  1153.0  31.1  66.0  3.4   
2022-08-06 13:16:00  1289.0  758.1  519.2  1191.0  1179.0  31.4  65.9  4.1   

                     WSgust  WSstdev     WD  WDstdev   BP  Cleaning  \
Timestamp                                                             
2021-08-09 11:12:00     4.1      0.6  175.8     13.3  999         0   
2021-08-09 11:15:00     4.6      0.4  169.1     12.3  999         0   
2021-08-09 11:17:00     3.6      0.6  208.0     15.9  999         0   
2021-08-09 14:10:00     3.9      0.5  241.2      7.9  997         0   
2021-08-09 14:11:00     3.1      0.6  225.6     10.7  997         0   
...                     ...      ...    ...      ...  ...       ...   
2022-08-03 13:38:00     3.6      0.6  258.7     14.1  995         0   
2022-08-05 13:40:00     5.1      0.7  240.4     12.0  997         0   
2022-08-05 14:17:00     3.9      0.6  190.5     16.7  996         0   
2022-08-06 13:15:00     4.6      0.7  288.7     14.6  996         0   
2022-08-06 13:16:00     5.1      0.7  259.4     13.9  996         0   

                     Precipitation  TModA  TModB  Comments     z_ghi  
Timestamp                                                             
2021-08-09 11:12:00            0.0   63.7   53.1       NaN  3.120942  
2021-08-09 11:15:00            0.0   65.0   53.5       NaN  3.347438  
2021-08-09 11:17:00            0.0   66.0   53.9       NaN  3.302139  
2021-08-09 14:10:00            0.0   57.6   52.1       NaN  3.057523  
2021-08-09 14:11:00            0.0   58.7   53.6       NaN  3.271939  
...                            ...    ...    ...       ...       ...  
2022-08-03 13:38:00            0.0   53.2   45.1       NaN  3.102822  
2022-08-05 13:40:00            0.0   53.5   45.5       NaN  3.139061  
2022-08-05 14:17:00            0.0   57.6   48.2       NaN  3.030343  
2022-08-06 13:15:00            0.0   62.1   53.1       NaN  3.084702  
2022-08-06 13:16:00            0.0   63.0   54.0       NaN  3.166241  

[89 rows x 19 columns]
Anomalies in Sierra Leone:
                         GHI    DNI    DHI    ModA    ModB  Tamb    RH   WS  \
Timestamp                                                                    
2021-10-30 11:04:00  1119.0  673.5  538.4  1193.0  1167.0  26.3  83.1  0.1   
2021-10-30 11:12:00  1154.0  755.7  491.3  1237.0  1208.0  27.0  82.4  1.2   
2021-10-30 13:01:00  1111.0  812.0  361.4  1189.0  1162.0  29.5  73.0  0.7   
2021-10-30 13:02:00  1126.0  815.0  373.3  1202.0  1175.0  29.7  72.4  0.6   
2021-10-30 13:03:00  1151.0  813.0  400.1  1226.0  1198.0  30.0  72.2  2.1   
...                     ...    ...    ...     ...     ...   ...   ...  ...   
2022-10-24 13:08:00  1134.0  674.6  497.0  1169.0  1143.0  29.9  73.8  2.5   
2022-10-24 13:09:00  1162.0  715.4  487.6  1198.0  1171.0  29.9  75.8  2.8   
2022-10-24 13:10:00  1163.0  730.8  475.6  1199.0  1173.0  29.9  75.0  2.5   
2022-10-24 13:11:00  1125.0  698.6  467.5  1159.0  1133.0  30.1  76.5  2.9   
2022-10-24 14:24:00  1109.0  762.0  470.3  1130.0  1109.0  30.6  73.1  2.7   

                     WSgust  WSstdev     WD  WDstdev    BP  Cleaning  \
Timestamp                                                              
2021-10-30 11:04:00     1.1      0.3  100.5      6.9  1002         0   
2021-10-30 11:12:00     1.9      0.6   69.5     12.6  1002         0   
2021-10-30 13:01:00     1.4      0.6  164.7      7.7  1000         0   
2021-10-30 13:02:00     1.6      0.6  183.8     11.7  1000         0   
2021-10-30 13:03:00     2.6      0.5  205.7     11.9  1000         0   
...                     ...      ...    ...      ...   ...       ...   
2022-10-24 13:08:00     3.4      0.8  264.2     19.6  1001         0   
2022-10-24 13:09:00     3.9      0.6  266.2     13.2  1001         0   
2022-10-24 13:10:00     3.1      0.4  249.4     15.8  1001         0   
2022-10-24 13:11:00     3.9      0.7  237.3     21.0  1001         0   
2022-10-24 14:24:00     3.4      0.5  249.8      7.5  1000         0   

                     Precipitation  TModA  TModB  Comments     z_ghi  
Timestamp                                                             
2021-10-30 11:04:00            0.0   60.5   53.2       NaN  3.072222  
2021-10-30 11:12:00            0.0   66.1   59.2       NaN  3.189477  
2021-10-30 13:01:00            0.0   66.4   63.5       NaN  3.045421  
2021-10-30 13:02:00            0.0   68.1   64.9       NaN  3.095673  
2021-10-30 13:03:00            0.0   69.5   66.0       NaN  3.179426  
...                            ...    ...    ...       ...       ...  
2022-10-24 13:08:00            0.0   51.1   51.7       NaN  3.122474  
2022-10-24 13:09:00            0.0   52.4   53.0       NaN  3.216278  
2022-10-24 13:10:00            0.0   53.5   54.2       NaN  3.219628  
2022-10-24 13:11:00            0.0   54.8   55.6       NaN  3.092323  
2022-10-24 14:24:00            0.0   47.4   50.2       NaN  3.038721  

[2477 rows x 19 columns]
Anomalies in Togo:
                         GHI    DNI    DHI    ModA    ModB  Tamb    RH   WS  \
Timestamp                                                                    
2022-04-15 12:18:00  1223.0  615.1  597.3  1154.0  1123.0  35.4  45.1  4.0   
2022-04-15 12:19:00  1267.0  666.5  593.3  1194.0  1164.0  35.3  45.3  3.5   
2022-04-15 12:20:00  1243.0  652.7  578.6  1167.0  1137.0  35.4  45.1  5.6   
2022-04-15 12:24:00  1234.0  632.0  589.4  1156.0  1125.0  35.2  45.5  4.5   
2022-04-15 12:26:00  1263.0  653.3  602.0  1185.0  1154.0  35.3  45.8  4.2   
...                     ...    ...    ...     ...     ...   ...   ...  ...   
2022-10-14 10:51:00  1221.0  811.8  450.7  1255.3  1237.0  29.9  70.1  4.9   
2022-10-14 10:53:00  1285.0  862.8  460.8  1309.4  1290.0  30.1  67.8  5.1   
2022-10-14 10:54:00  1202.0  748.9  494.9  1242.3  1225.0  30.1  68.0  4.4   
2022-10-14 10:55:00  1267.0  790.9  514.5  1299.4  1280.0  30.1  68.6  4.0   
2022-10-14 10:57:00  1214.0  699.2  542.7  1244.3  1226.0  30.3  69.2  2.4   

                     WSgust  WSstdev     WD  WDstdev   BP  Cleaning  \
Timestamp                                                             
2022-04-15 12:18:00     5.2      0.6  226.0     14.6  974         0   
2022-04-15 12:19:00     4.1      0.5  225.6     17.6  974         0   
2022-04-15 12:20:00     7.7      1.0  204.3     11.2  974         0   
2022-04-15 12:24:00     5.7      0.9  198.7     16.0  974         0   
2022-04-15 12:26:00     6.4      1.4  224.1     18.8  974         0   
...                     ...      ...    ...      ...  ...       ...   
2022-10-14 10:51:00     6.2      0.8  151.2     17.3  978         0   
2022-10-14 10:53:00     6.4      0.9  182.7     13.4  978         0   
2022-10-14 10:54:00     6.4      1.2  169.9     10.9  978         0   
2022-10-14 10:55:00     5.2      0.9  160.1     15.0  978         0   
2022-10-14 10:57:00     4.1      0.7  165.5     23.4  978         0   

                     Precipitation  TModA  TModB  Comments     z_ghi  
Timestamp                                                             
2022-04-15 12:18:00            0.0   57.9   61.4       NaN  3.077043  
2022-04-15 12:19:00            0.0   58.5   62.1       NaN  3.213464  
2022-04-15 12:20:00            0.0   59.1   62.8       NaN  3.139052  
2022-04-15 12:24:00            0.0   58.7   62.8       NaN  3.111148  
2022-04-15 12:26:00            0.0   59.5   63.0       NaN  3.201062  
...                            ...    ...    ...       ...       ...  
2022-10-14 10:51:00            0.0   52.7   62.2       NaN  3.070842  
2022-10-14 10:53:00            0.0   53.7   62.9       NaN  3.269272  
2022-10-14 10:54:00            0.0   54.2   63.4       NaN  3.011933  
2022-10-14 10:55:00            0.0   54.9   64.3       NaN  3.213464  
2022-10-14 10:57:00            0.0   56.1   65.6       NaN  3.049139  

[305 rows x 19 columns]




# Cleaing the data 

def clean_data(df):
    df.fillna(method="ffill", inplace=True)
    df = df[df["GHI"] >= 0]  
    return df

cleaned_data = {name: clean_data(df) for name, df in datasets.items()}




# all the cleaned data 



# save cleaned data set
for name, df in cleaned_data.items():
    df.to_csv(f"../results/cleaned_{name.lower().replace(' ', '_')}.csv", index=False)



